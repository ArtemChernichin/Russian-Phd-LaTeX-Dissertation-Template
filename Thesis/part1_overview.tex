\chapter{Проблема построения портфеля торговых стратегий на финансовом рынке}
\section{Торговые стратегии и диверсификация рисков}
\note{Для начала надо рассказать про актуальность задачи диверсификации.}
Рациональное инвестирование денежных средств в рыночные активы подразумевает взвешенную оценку риска инвестирования и ожидаемой доходности. 
На рынке присутствует огромное количество активов с разными свойствами. Все активы в большей или меньшей степени подвержены рискам, например:
\begin{enumerate}
	\item рыночный риск -- непредсказуемое поведение рынка, влияющее на все или часть секторов
	\item риск ликвидности
	\item риски компаний
\end{enumerate}
Инвестора можно рассматривать как рационального агента, который имеет некоторую функцию предпочтений относительно активов.

\note{Инвестор предпочитает из двух портфелей с одинаковой доходностью тот, у которого волатильность меньше}
Введем предпосылки о предпочтениях инвесторов:
\begin{itemize}
	\item Инвесторы избегают риск
	\item Инвесторы экономически целесообразны
\end{itemize}
Тогда можно сказать, что для любых двух активов с одинаковой доходностью предпочитается тот, который имеет меньший риск\footnote{Под риском здесь можно понимать стандартное отклонение доходностей актива.}, тем самым инвесторы избегают излишний риск.  

\note{Из двух с одинаковой волатильностью тот, чья доходность больше}
Из двух активов с одинаковым риском предпочитается тот, чья доходность больше, что соответствует предпосылке об экономической целесообразности.

\note{Из нескольких активов можно комбинировать портфель с приемлемым соотношением риск-доходность}
Однако дискретный выбор одного единственного актива может не быть оптимальным выбором с точки зрения инвестора. Поскольку разные активы имеют разное соотношение риска и доходности, инвестору имеет смысл выбирать тот взвешенный набор активов, который бы максимизировал его функцию предпочтений диверсифицируя риск.

\note{Дальше стоит сказать про то, какие бывают портфели вообще, рассказать про доступное пространство риск - доходность, так как читатель может быть не знаком с этой теорией}
С математической точки зрения всевозможные выпуклые комбинации образуют доступное множество соотношений риск-доходность. Выбор оптимальной -- задача портфельной оптимизации. При этом учитываются особенности совместного распределения доходностей активов. В отличии от матожидания, дисперсия доходности портфеля не может быть получена линейной комбинацией дисперсий компонент. 

\note{Про алгоритмы. Необходимо четко обозначить то, что такое алгоритм и что это набор заранее определенных правил, кем то придуманный. Не останавливаясь на том, как они создаются, это будет в следующей части. Цели создания алгоритмов}
Существуют различные работы подтверждающие факт непостоянства рыночной ситуации. Меняются ожидаемые доходности активов и риски связанные с каждым из них. Таким образом, может быть полезным периодически переоценивать ситуацию на рынке и менять структуру портфеля. 

\note{Адаптивный портфель под изменяющуюся структуру рынка.}
Заранее заданные правила пересмотра называют торговой стратегией(алгоритмом). В течении периода работы алгоритм составляет динамически меняющийся портфель. Есть надежда, что торговая стратегия позволит диверсифицировать риски, связанные с изменением рыночной конъюнктуры и, в тоже время, от рисков, связанных с отдельными компаниями. 

\note{Надежды на возможность предсказать движение рыночных сил тут нет, лишь попытка снизить риск}
Автономность алгоритма и абстракция от специфики отрасли или отдельной компании дают надежду на то, что в какой-то степени получится этих рисков избежать. Однако стоит заметить, что возникают риски специфичные именно для алгоритмов:
\begin{itemize}
	\item риск непредсказуемого поведения
	\item риск смещенной оценки ожидаемой доходности
	\item риск смещенной оценки волатильности
\end{itemize}
Эти риски возникают по причине того, что каждый алгоритм создается человеком, наблюдающим результат процесса своей деятельности (создания алгоритма). Будущее поведение алгоритма не определено.

\note{Возможность создания бесконечного многообразия торговых стратегий, как следствие можно составлять портфель из них, правильно учтя их свойства}
Диверсификация этих рисков требует качественного подхода к анализу доходностей, которые генерируются алгоритмом. Одним из простейших подходов будет формирование портфеля из торговых стратегий, которые будут в заданных долях делить имеющиеся для инвестирования средства.

\section{Особенности анализа доходностей торговых стратегий}
\note{Структурные сдвиги}
Первая важная особенность торговых стратегий состоит в том, что они создаются человеком, автором. Автору доступна информация о том, как бы действовал алгоритм на исторических данных. Эта процедура называется <<бэктест>>, с ее помощью можно получить огромное количество статистик для дальнейшего анализа эффективности стратегии. Ориентируясь на эту информацию можно составить стратегию, которая хорошо работает на исторических данных. 

К сожалению, на последующем периоде поведение алгоритма непредсказуемо. Это является структурным сдвигом для торговой стратегии. Все что было до момента создания принимать во внимание, конечно, стоит, но с большой осторожностью, доверять следует статистикам, которые получены на периоде после создания.
 
\note{Динамика волатильности (часто наблюдается и вообще у активов)}
В моделировании финансовых рядов обычно используются модели с непостоянной волатильностью (GARCH). Оснований утверждать, что для стратегий волатильность доходностей постоянна во времени -- нет. Корректная оценка рисков, связанных с непостоянной волатильностью, требует модели волатильности.

\note{Изменение характера взаимосвязи, уточнив., что гипотеза основана на анализе просто активов}
В ряде исследований был выявлен факт непостоянства корреляций между доходностями компаний во времени. Так, например, в период кризисов корреляции усиливается. Рынок сильно влияет на эти связи непредсказуемым образом, похожие эффекты могут наблюдаться и для торговых стратегий. Моделирование динамики взаимосвязей поможет должным образом учесть эти риски.
\section{Формирование портфеля торговых стратегий}
Тут обзор портфельной теории марковица и его аналогов\footnote{\href{http://web.mit.edu/econometrics/Bucciol\_Miniaci\_2006.pdf}{http://web.mit.edu/econometrics/Bucciol\_Miniaci\_2006.pdf}}, и финальная фраза о том, что нам нужен последний метод

\begin{comment}
\textit{Торговая стратегия (алгоритм)} -- набор заранее заданных правил по проведению операций на бирже. 
Эти правила определяют какую позицию (короткую или длинную) занять по каждому инструменту с определенной периодичностью. Таким образом алгоритм формирует динамический портфель, стоимость которого можно посчитать в любой момент времени. Понятие доходности применимо для торговых стратегий.

Пусть $\;\mathcal{U}$ -- множество доступных для торговли инструментов, $\mathcal{H}_t$ -- информационное множество доступное в момент времени $t$, $p_t$ -- цены инструментов в момент $t$,  $\mathcal{A}$ - множество стратегий таких, что:
\begin{align}
	a \in \mathcal{A} \colon \mathcal{H}_t \rightarrow w_t &\in \mathbb{R}^{|\mathcal{U}|}\\ 
	\sum_{i=1}^{|\mathcal{U}|} w_{it} &= 1,
\end{align}
где $\{w_{it}\} = w_t$ - веса инструментов $\{u_i\} = \mathcal{U}$ соответственно. 
Изменение структуры портфеля происходит с комиссией. 
Размер комиссии зависит от старого и нового набора $w$, обозначим
\begin{align}
	\textit{C} \colon w &\times w \rightarrow \mathbb{R}_+\\
	\textit{C}(w, w') &= 0 \iff w = w'	
\end{align}
Таким образом стоимость $R_t$ нового портфеля выражается формулой
\begin{align}
	w_{t} &= a(\mathcal{H}_t)\\
	R_t &= w_{t}^\top p_t - \textit{C}(w_{t}, w_{t-1})
\end{align}
Инвестор надеется, что в будущем $R_{t+1} > R_t$. 
Комиссия играет важную роль в алгоритмической торговле. 
Слишком частые действия на рынке могут влечь за собой высокие транзакционные издержки и быть нецелесообразными.
\subsection{Частные случаи}
\paragraph{Buy \& Hold}
Заметим, что если $a(\mathcal{H}_t) = const$, то мы получим стратегию <<buy and hold>>, равносильную пассивному держанию портфеля активов. Её транзакционные издержки будут нулю.
\paragraph{Актив}
Если же $w = a(\mathcal{H}_t)$ имеет вид $(0, 0, \dots, \underset{i}{1}, \dots, 0)^\top$, то это будет соответствовать тривиальной длинной позиции по одному активу $i$.
\subsection{Отличия торговых стратегий от портфелей и активов}
Каждая торговая стратегия - творение человека, \textit{автора}. 
И человек, что ее создавал обладал информацией о результативности своей стратегии на исторических данных.
Стараясь сделать хорошую стратегию, автор неявно учитывает особенности периода, который доступен для бэктеста.
Бэктест -- анализ стратегии на исторических данных, включает в себя расчет статистических показателей: коэффициент Шарпа\footnote{
	$SR = \frac{\Eb{r_p-r_f}}{\sigma_p}$, где $r_p$, $\sigma_p$ -- доходность, стандартное отклонение доходности портфеля соответственно, $r_f$ -- доходность безрискового актива
}, среднюю доходность, риск.

Таким образом стратегия, которая себя может и показала хорошо на бэктесте, может быть совершенно непредсказуемой после него.
Момент создания стратегии -- структурный сдвиг, который необходимо учитывать, оценивая истинную доходность стратегии. 
\end{comment}